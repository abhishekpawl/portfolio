
# Artificial Intelligence

## Machine Learning
- predict
- classify data
- group data

## Anomaly Detection
- use ML to analyse data
- watches for trends and finds outliers in the data
- anything that deviates from the standard pattern

## Computer Vision
- examines images, videos or live capture from a camera
- *object detection* and *facial recognition*
- optical character recognition to extract text from images

## Natural Language Processing
- voice assistants
- analyses and interprets text
- automatically translates spoken or written languages

## Conversational AI
- AI systems that can chat with humans
- online chatbots that asks if you need any help
- can be used for customer support or a reservation system
- answers users' commonly asked questions

## Knowledge Mining
- data extraction
- enrich the data
- explore the data

## Creating Responsible AI
- **Fairness**
	- AI should treat all people fairly
	- limit biases in AI systems
	- make sure the application doesn't discriminate against people
- **Reliability and Safety**
	- ensuring AI systems can handle errors or values it doesn't expect, operate as designed, and resist manipulation
- **Privacy and Security**
	- AI systems should be private and secure
	- secure data so no user data is leaked or disclosed
	- provide customers and users with information and controls how the system stores their data
- **Inclusiveness**
	- AI systems should empower all people
- **Transparency**
	- users should be fully aware of how the system works and what the limitations are
- **Accountability**
	- people should be held accountable for AI systems
	- AI systems should follow governance and frameworks to meet legal and ethical standards

---

# Machine Learning

## Azure Services
- **Azure Automated Machine Learning**
	- select a dataset
	- pick a label
- **Azure Machine Learning Designer**
	- create a pipeline to train a ML model
	- no code
	- drag-and-drop interface

## Regression
- use historical data with features and labels to predict a numerical value
- predicting a *numerical value*

## Classification
- using historical data with features and labels to predict a category or class
- predicting a *category or class*

## Clustering
- grouping similar items into clusters based on their features
- example of unsupervised learning
- *grouping* similar items together

## Azure Automated Machine Learning
- machine learning workspace -> Automated ML
- virtual machines - to run our workload

## Data Preparation
- before training, data should be *prepared*
- there might be rows with missing data or null values
- *normalisation* - for values in same scale

## Training the model
- algorithm

## Validation
- splitting data into training and validation sets
- **split data module**

## Evaluation
- metrics to evaluate the model

## Azure ML Designer
- creating pipelines
- adding modules one after another in designer
- drag and drop canvas
- resources required - ![[resources-designer.jpeg]]
- Designer example - ![[designer.jpeg]]

## Inference pipelines
- to make prediction on unknown data
- **Web Service Input/Output** - to communicate with the model
- exposed as a REST API endpoint

## Clustering pipelines
- *k-means clustering* - only option
- configure - number of centroids
- Designer example - ![[cluster-designer.jpeg]]

---

# Computer Vision
## Services
- Azure Computer Vision
	- interact via API endpoint and key
- Azure Cognitive Services - (a big umbrella)

|                    Standalone Service                    |                   Cognitive Services                   |
| :------------------------------------------------------: | :----------------------------------------------------: |
|             no plan of using other services              |     use multiple AI services with only 1 resource      |
| we want to track utilisation and costs for CV separately | simplify administration with a single endpoint and key |
## Computer Vision ***capabilities***
- description
	- short phrases or sentences that describes *what is in the image*
	- multiple descriptions - confidence score
- tags
	- key terms for the image
- object detection
	- identify the objects found in the image
	- object - bounding box
- brand detection
- facial detection
- categorize
	- (a picture of tree) plant_tree, (nike shoes) people_young
	- an image can be categorised as one of the pre-defined 86 classes
- landmarks and celebrities detection
- optical character recognition
	- reading text from a picture
- moderate content

## Example - image analysis
- Azure AI services multi-service account
- Image analysis - (in Azure CLI bash env)
	- `cog_endpoint`, `cog_key` - Azure AI services multi-service account endpoint
		- from *Keys and Endpoint*
```python
from azure.cognitiveservices.vision.computervision import ComputerVisionClient
from azure.cognitiveservices.vision.computervision.models import VisualFeatureTypes
from msrest.authentication import CognitiveServicesCredentials
import os

class colors:
    green = '\033[92m'
    blue = '\033[94m'
    red = '\033[31m'
    yellow = '\033[33m'
    reset = '\033[0m'

# Paste your endpoint and key below
cog_endpoint = "Paste_endpoint_here"
cog_key = "Paste_key_here"
computervision_client = ComputerVisionClient(cog_endpoint, CognitiveServicesCredentials(cog_key))


# Change the URL between the quotes below to run your own images!
image_to_analyze = "https://raw.githubusercontent.com/pluralsight-cloud/AI-900-Artificial-Intelligence-Workloads-and-Considerations/main/images/image-analysis/1-computervision-couple.jpg"


image_analysis = computervision_client.analyze_image(image_to_analyze,visual_features=[VisualFeatureTypes.description,
 VisualFeatureTypes.tags, VisualFeatureTypes.faces])

print("\n-----Image Description-----")
for caption in image_analysis.description.captions:
    print(f"{colors.green}Confidence: {colors.reset}" + str(caption.confidence))
    print(f"{colors.green}Description: {colors.reset}" + caption.text)
print("----------\n")


input("Press Enter to continue to image tags...\n")


print("-----Image Tags-----")
for tag in image_analysis.tags:
    print(f"{colors.green}Tag:{colors.reset} {tag.name:<15}", 
    f" {colors.yellow}Confidence:{colors.reset} {tag.confidence:<15}")
print("----------\n")


input("Press Enter to continue to face detection...\n")


print("-----Face Detection-----")
for face in image_analysis.faces:
    print("Face at location {},{},{},{}".format( face.face_rectangle.left, face.face_rectangle.top, \
        face.face_rectangle.left + face.face_rectangle.width, \
        face.face_rectangle.top + face.face_rectangle.height))
print("----------")

input("\nPress Enter to Exit...")
```

## Custom Vision
- train our own model
- *the standalone service will deploy both training and prediction resources*
	- 2 endpoints and 2 keys
- services
	- image classification
	- object detection

## Cognitive Services
- only one endpoint and key

## Azure Face Service
- to *detect*, *analyse* and *recognise* faces
- **Azure Face**
	- as its own HTTP endpoint and key
- **Azure Cognitive Services**

## Azure Face capabilities
- resource type - *Azure AI services multi-service account*
- Facial analysis
	- analyze faces for various attributes
- Facial recognition
	- training a model to recognize someone based on their features
- Face analysis - (in Azure CLI bash env)
	- `cog_endpoint`, `cog_key` - Azure AI services multi-service account endpoint
		- from *Keys and Endpoint*
```python
from azure.cognitiveservices.vision.face import FaceClient
from msrest.authentication import CognitiveServicesCredentials
import os

class colors:
    green = '\033[92m'
    blue = '\033[94m'
    red = '\033[31m'
    yellow = '\033[33m'
    reset = '\033[0m'

# Paste your endpoint and key below
cog_endpoint = "Paste_endpoint_here"
cog_key = "Paste_key_here"
face_client = FaceClient(cog_endpoint, CognitiveServicesCredentials(cog_key))


# Change the URL between the quotes below to run your own faces through the Azure Face Service!
face_to_analyze = "https://raw.githubusercontent.com/pluralsight-cloud/AI-900-Artificial-Intelligence-Workloads-and-Considerations/main/images/image-analysis/2-azureface-couple.jpg"

detected_faces = face_client.face.detect_with_url(url=face_to_analyze, 
return_face_attributes=list(['headPose','glasses','accessories','blur','noise','occlusion']), 
return_face_landmarks=True,
return_face_id=False)
if not detected_faces:
    print("No faces were found in the image! Please try another image!")
    input("Press Enter to exit")
    quit()

print("\n-----Facial Attributes-----")
for count, face in enumerate(detected_faces):
    print()
    print(f"{colors.green}\nPerson Number: {colors.reset}" + str(count))
    for acc in face.face_attributes.accessories:
        print(f"{colors.red}\nAccessories: {colors.reset}" + str(acc))
    print(f"{colors.yellow}\nGlasses: {colors.reset}" + str(face.face_attributes.glasses))
    print(f"{colors.blue}\nBlur: {colors.reset}" + str(face.face_attributes.blur.blur_level))
    print(f"{colors.green}\nOcclusion: {colors.reset}" + str(face.face_attributes.occlusion))
    print(f"{colors.red}\nNoise Level: {colors.reset}" + str(face.face_attributes.noise.noise_level))
    print("\n----------\n")

input("\nPress Enter to Exit...")
```

## Optical Character Recognition (OCR)
- reading text from images
- *OCR Engine* - **Read API** - for a small amount of text
- **Form Recognizer** - for large amounts of text
- Services
	- *Azure Computer Vision*
	- *Azure Cognitive Services*

### Form Recognizer
- read texts from images of receipts, invoices and forms
- resource type - *Cognitive Services multi-service account*
	- -> *Form Recognizer*
	- -> *Form Recognizer Studio*
	- -> pre-built models

|                                  OCR                                   |            Form Recognizer             |
| :--------------------------------------------------------------------: | :------------------------------------: |
| we would still need to sort out the details and match fields to values | automatically matches fields to values |

---

# Natural Language Processing

*Azure breaks NLP down into 4 services*
- Text Analytics
- Speech
- Translator
- Language Understanding

## Uses
- speech synthesis
- speech recognition
- speech and text translation
- perform text analytics to detect sentiments
- extract key phrases
- detect entities

## Text Analytics
- language detection
	- determine the language of a comment
	- focuses on the more predominant language
	- if it can not determine - *unknown language* or *NaN*
- sentiment analysis
	- determine if a text is highly positive or negative
- extract key phrases
- entity recognition
	- return a list of entities in the text and the category they are assigned to
- *Services*
	- Text Analytics Service
	- Azure Cognitive Service

## Azure Speech
- speech recognition
	- spoken language (live audio / audio file) -> data/text
	- automated note taking
	- *Speech-to-text API*
- speech synthesis
	- text -> speech
	- *Text-to-speech API*
- *Services*
	- Azure Speech
	- Azure Cognitive Services

## Translator
- document \[from one language to another\]
- text translation
	- supports more than 60 languages
	- profanity filter
	- tag content
- speech translation
	- automatic translation during a presentation
	- spoken language -> text - speech-to-text
- *Services*
	- Translator Text Service
	- Azure Speech
		- speech-to-text
		- speech-to-speech
	- Azure Cognitive Services

## Language Understanding
- 3 concepts
	- **Utterances**
		- the *phrase*
	- **Entities**
		- *item* to which the phrase is referring to
		- e.g. start the ==coffee machine==
		- e.g. turn on the ==lights==
	- **Intent**
		- *purpose/goal* of the phrase
		- e.g. start, turn on
- *Services*
	- Language Understanding Service (LIS)
		- authoring - train our service by defining entities, utterances and intent
		- prediction - model for use
	- Azure Cognitive Services

## Conversational AI
- chatbot to answer simple questions
- knowledge base
	- list of question and answer pairs
- bot service
	- interface
- *Service*
	- Cognitive Services for Language
		- enables to create a knowledge base of q/a
	- Azure Bot Service
		- create a bot service

### Cognitive Services for Language
- interact
	- REST API
	- software development kit
	- language studio
- generate q/a pairs from an existing faq doc
- import for pre-defined chit-chat source
- input q/a manually

### Azure Bot Service
- create interface via - email, web, ms teams...
- created
	- via *Bot Framework SDK*
	- in the *Language Studio for Cognitive Services for Language*


### Power Virtual Agents
- to create AI-powered chatbots
- no-code interface
- standalone web app / app inside MS Teams

---

